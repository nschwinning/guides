### Create stream

```sql
CREATE STREAM test WITH (KAFKA_TOPIC = 'horizon.trade.updates', VALUE_FORMAT = 'Avro');
```

### Query stream

```sql
SELECT * FROM test WHERE TRADE='80171723';
```

### Create stream with a few fields

```sql
CREATE STREAM trade (
	TRADE STRING,
	DATAPUSHTIME BIGINT,
	STATUS STRING
)
WITH (KAFKA_TOPIC = 'horizon.trade.updates', VALUE_FORMAT = 'Avro');
```

### Create persistent stream

```sql
CREATE STREAM FILTERED AS SELECT
  TRADE,
  STATUS,
  DATAPUSHTIME
FROM TRADE
WHERE STATUS = 'ACTIVE'
EMIT CHANGES;
```

### Create table

```sql
CREATE TABLE TEST WITH (KAFKA_TOPIC='TEST', PARTITIONS=1, REPLICAS=1) AS SELECT
    TRADE, MAX(DATAPUSHTIME) AS MAXDATE
FROM FILTERED
GROUP BY TRADE
EMIT CHANGES;
```

### Create topic on table

```sql
CREATE STREAM MAX AS SELECT
    TRADE, DATAPUSHTIME
FROM FILTERED
WHERE DATAPUSHTIME > SELECT MAXDATE FROM TEST
EMIT CHANGES;
```
```sql
CREATE STREAM MAX AS SELECT
    TRADE, DATAPUSHTIME
FROM FILTERED
WHERE DATAPUSHTIME > (SELECT MAXDATE FROM TEST WHERE TRADE=TRADE)
EMIT CHANGES;
``` 